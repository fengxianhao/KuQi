var qikoo=window.qikoo||{};qikoo.widget=qikoo.widget||{},qikoo.like=function(){var e=function(e,r){$.post("/submit/addXh",{id:r},function(i){i.errno==0?(t(e,r),n(e)):(i.errno==20001||i.errno==20002)&&n(e)},"json")},t=function(e,t){var e=e.filter("[data-id="+t+"]"),n=e.find("em"),r=parseInt(n.eq(0).text());r>=0&&n.empty().text(r+1)},n=function(e){e.addClass("is-liked").attr("title","\u5df2\u559c\u6b22")},r=function(t){var n=$(t);n.click(function(){var t=$(this),n=t.attr("data-id");t.hasClass("is-liked")||e(t,n)})};return{init:r}}(),qikoo.share=function(){var e,t={},n=function(e){var t=[];return $.each(e,function(e,n){t.push(e+"="+encodeURIComponent(n))}),t.join("&")},r=function(){var e=t.title||document.title;e.indexOf("@Qikoo\u5947\u9177\u7f51")==-1&&e.indexOf("@qikoo\u5947\u9177\u7f51")==-1&&(e+=" @Qikoo\u5947\u9177\u7f51 ");var r={url:t.url||window.location.href,type:"button",language:"zh_cn",pic:t.pic||"",title:e,searchPic:"true",style:"simple"},i="http://service.weibo.com/share/share.php?"+n(r);window.open(i)},i=function(e,n){var i=$(e);t=n,i.click(function(){r()})};return{init:i}}(),qikoo.dialog=function(){var e,t,n,r=function(){var n=['<div class="mod-dialog-bg"></div>','<div class="mod-dialog">','<div class="dialog-nav">','<span class="dialog-title"></span>','<a href="#" onclick="return false" class="dialog-close"></a>',"</div>",'<div class="dialog-main"></div>',"</div>"].join(""),r=$(n).hide().appendTo("body");e=r.filter(".mod-dialog-bg"),t=r.filter(".mod-dialog"),t.find(".dialog-close").click(function(){u()})},i=function(){t.css("width",n.width||""),t.find(".dialog-title").html(n.title),t.find(".dialog-main").html(n.html),t.show(),e.show(),s()},s=function(){var e=($(window).width()-t.width())/2,n=($(window).height()-t.height())/2;n=n>0?n+$(window).scrollTop():0,t.css({left:e,top:n})},o=function(e){return typeof e!="object"&&(e={html:e||""}),n=$.extend({title:"\u63d0\u793a",html:"",closeFn:null},e),t||r(),i(),t},u=function(){e.hide(),t.hide(),n.closeFn&&n.closeFn.call(this)};return{show:o,hide:u}}(),qikoo.dialog.confirm=function(e,t,n){var r=['<div class="dialog-content">',"<p>"+e+"</p>","</div>",'<div class="dialog-console clearfix_new">','<a class="console-btn-confirm" href="#" onclick="return false;">\u786e\u5b9a</a>','<a class="console-btn-cancel" href="#" onclick="return false;">\u53d6\u6d88</a>',"</div>"].join(""),i=qikoo.dialog.show({html:r});i.find(".console-btn-confirm").click(function(){t&&t.call(i),qikoo.dialog.hide()}),i.find(".console-btn-cancel").click(function(){n&&n.call(i),qikoo.dialog.hide()})},qikoo.dialog.alert=function(e,t){var n=['<div class="dialog-content">',"<p>"+e+"</p>","</div>",'<div class="dialog-console clearfix_new">','<a class="console-btn-confirm" href="#" onclick="return false;">\u786e\u5b9a</a>',"</div>"].join(""),r=qikoo.dialog.show({html:n});r.find(".console-btn-confirm").click(function(){t&&t.call(r),qikoo.dialog.hide()})},qikoo.dialog.payNotice=function(e,t,n){e=e||function(){window.location.reload()},t=t||function(){window.location.reload()};var r=qikoo.dialog.show({html:['<div class="dialog-content" style="padding: 0 80px; text-align:left">','<div class="content-title">\u8bf7\u60a8\u5728\u65b0\u6253\u5f00\u7684\u9875\u9762<br>\u4e0a\u5b8c\u6210\u4ed8\u6b3e\u3002</div>','<p style="padding-left: 50px">\u4ed8\u6b3e\u5b8c\u6210\u524d\u8bf7\u4e0d\u8981\u5173\u95ed\u6b64\u7a97\u53e3\u3002<br>\u5b8c\u6210\u4ed8\u6b3e\u540e\u8bf7\u6839\u636e\u60a8\u7684\u60c5\u51b5\u70b9\u51fb\u4e0b\u9762\u7684\u6309\u94ae\uff1a</p>',"</div>",'<div class="dialog-console clearfix_new" style="margin:25px auto;width:252px;">','<a class="console-btn-confirm" href="#" onclick="return false;">\u5df2\u5b8c\u6210\u4ed8\u6b3e</a>','<a class="console-btn-cancel" href="#" onclick="return false;">\u4ed8\u6b3e\u9047\u5230\u95ee\u9898</a>',"</div>"].join(""),width:530,closeFn:n});r.find(".console-btn-confirm").click(function(){e(),qikoo.dialog.hide()}),r.find(".console-btn-cancel").click(function(){t(),qikoo.dialog.hide()})},qikoo.pop=function(e){var t,n=['<div class="mod-pop">','<div class="pop-nav">','<span class="pop-title"></span>','<a class="pop-close" href="#" onclick="return false"></a>',"</div>",'<div class="pop-main"></div>',"</div>"].join("");return t=$(n).hide().appendTo("body"),t.find(".pop-close").click(function(){t.remove()}),e=$.extend({title:"\u6e29\u99a8\u63d0\u793a\uff1a",html:""},e),t.find(".pop-title").html(e.title),t.find(".pop-main").html(e.html),t},qikoo.popConfirm=function(){var e,t=function(e){var t=["<p>"+e+"</p>",'<div class="pop-console">','<a class="pop-btn-green" href="#" onclick="return false">\u786e\u5b9a</a>','<a class="pop-btn-gray" href="#" onclick="return false">\u53d6\u6d88</a>',"</div>"].join("");return qikoo.pop({title:"\u6e29\u99a8\u63d0\u793a\uff1a",html:t})},n=function(t){var n=$(t).offset();n.left=n.left-e.width(),n.top=n.top-e.height(),n.left<0&&(n.left=0),n.top<0&&(n.top=0),e.css(n)},r=function(t){e.find(".pop-btn-gray").click(function(){i()}),e.find(".pop-btn-green").click(function(){t&&t.call(this),i()})},i=function(){e&&e.remove(),e=null};return function(s,o,u){i(),e=t(o),n(s),r(u),e.show()}}(),qikoo.search=function(){var e,t,n,r=function(){var e=t.val()||"";window.location.href="/search/"+encodeURIComponent(e)},i=function(){e=$("#qHeaderSearch"),t=e.find(".search-input"),n=e.find(".search-submit"),n.click(r),t.keypress(function(e){e.which==13&&r()})};return{init:i}}(),qikoo.browser=function(){var e=window.navigator,t=e.userAgent.toLowerCase(),n=/(msie|webkit|gecko|presto|opera|safari|firefox|chrome|maxthon|android|ipad|iphone|webos|hpwos|trident)[ \/os]*([\d_.]+)/ig,r={platform:e.platform};t.replace(n,function(e,t,n){r[t]||(r[t]=n)}),r.opera&&t.replace(/opera.*version\/([\d.]+)/,function(e,t){r.opera=t}),!r.msie&&r.trident&&t.replace(/trident\/[0-9].*rv[ :]([0-9.]+)/ig,function(e,t){r.msie=t});if(r.msie){r.ie=r.msie;var i=parseInt(r.msie,10);r["ie"+i]=!0}return r}(),qikoo.msgTips=function(){var e=function(){$.ajaxSetup({cache:!1}),$.get("/message/syncmessage",function(e){var n=[],r=[["\u65b0\u8bc4\u8bba","\u8bc4\u8bba"],["\u65b0\u8bc4\u8bba","\u8bc4\u8bba"],["\u65b0\u8bc4\u8bba","\u8bc4\u8bba"],["\u8bd5\u7528\u6d88\u606f","\u8bd5\u7528"],["\u5956\u54c1\u6d88\u606f","\u5956\u54c1"],["\u7ad9\u5185\u6d88\u606f","\u6d88\u606f"]];if(e.errno==0){for(var i in e.errmsg)if(e.errmsg[i].num>0){var s=parseInt(e.errmsg[i].tag_major)-1;n.push("<li>"+e.errmsg[i].num+"\u6761"+r[s][0]+'\uff0c<a href="'+e.errmsg[i].url+'">\u67e5\u770b'+r[s][1]+"</a></li>")}t(n.join(""))}},"json")},t=function(e){var t='<div class="msTips" style="top:'+($(".popUsername").position().top+$(".popUsername").height()+10)+'px;right:0px;"><a href="javascript:void(0);" class="btn_close"></a><div class="con"><ul>'+e+"</ul></div></div>";e&&$(".header-container").append(t)},n=function(){$("body").delegate("a.btn_close","click",function(){$.get("/message/syncnonemessage"),$(".msTips").remove()})},r=function(){setTimeout(function(){$(".msTips").remove(),e()},1e3),setInterval(function(){$(".msTips").remove(),e()},1e4),n()};return{init:r}}(),qikoo=qikoo||{},qikoo.widget=qikoo.widget||{},qikoo.widget.pagebar=function(){var e,t,n,r,i,s=3,o=function(){var e=['<div class="mod-pagebar">'];t>1&&e.push('<a class="pagebar-step box-left" href="#" onclick="return false" data-go="'+(t-1)+'"><i class="step-left"></i>\u4e0a\u4e00\u9875</a>');for(var i=1;i<=n;i++)Math.abs(i-t)<=s?i==t?e.push('<span class="pagebar-curr">'+i+"</span>"):e.push('<a class="pagebar-number" href="#" onclick="return false" data-go="'+i+'">'+i+"</a>"):i==1&&t-1>s+1?e.push('<a class="pagebar-number" href="#" onclick="return false" data-go="1">1 ...</a>'):i==1&&t-1==s+1?e.push('<a class="pagebar-number" href="#" onclick="return false" data-go="1">1</a>'):i==n&&n-t>s+1?e.push('<a class="pagebar-number" href="#" onclick="return false" data-go="'+i+'">... '+i+"</a>"):i==n&&n-t==s+1&&e.push('<a class="pagebar-number" href="#" onclick="return false" data-go="'+i+'">'+i+"</a>");t<n&&e.push('<a class="pagebar-step box-right" href="#" onclick="return false" data-go="'+(t+1)+'">\u4e0b\u4e00\u9875<i class="step-right"></i></a>'),e.push("</div>"),r.html(e.join(""))},u=function(){r.click(function(e){var t=$(e.target),n=t.attr("data-go");n&&i&&i(n)})},a=function(e){t=parseInt(e.currpage)||1,n=e.totalpage||1,r=$(e.element),i=e.onChange,n!=1&&(o(),u())};return{init:a}};var widgetComment=function(){var e={over:'\u5df2\u7ecf\u8d85\u51fa <em style="color:#f00;">{size}</em> \u5b57',normal:"\u8fd8\u53ef\u4ee5\u8f93\u5165 <em>{size}</em> \u5b57"},t,n=1,r=2,i=function(e){$.getJSON("/review/synclist/",{c:r,i:t,p:e,n:10,t:+(new Date)},function(t){qiku.token_=t.errmsg.token_,t.errmsg.num<10||t.errmsg.allnum<=10?$("#qikuComment").children(".nobdr").hide():(t.errmsg.num=10)&&$("#qikuComment").children(".nobdr").show(),t.errmsg.num!=0?$.each(t.errmsg.data,function(e,t){var n=["<li>",'<div class="pic">','<img src="'+t.mimageUrl+'" alt="'+t.mqname+'" title="'+t.mqname+'" />',t.issuperadmin==1?'<a style="color:red;" qid="'+t.qid+'" href="#" onclick="return false;" class="moveblack">\u62c9\u9ed1</a>':"","</div>",'<div class="txt">',t.isadmin==0?'<div class="nick">'+t.mqname+"</div>":'<div class="nick">'+t.mqname+'<span class="vip" title="\u4ea7\u54c1\u56e2\u961f"></span></div>',t.reply_qid==""?"":'<div class="quote"><span class="time">'+t.qname+"\u53d1\u8868\u4e8e "+t.refresh_at+'</span><div class="con">'+t.reply_content+"&nbsp;</div></div>",'<div class="content">'+t.content+"&nbsp;</div>",'<div class="info">','<span class="time">'+t.post_at+"</span>",'<a href="#" onclick="return false" class="breply" title="\u56de\u590d">\u56de\u590d</a>',t.issuperadmin==1?'<a href="#" onclick="return false" class="delrcm" title="\u5220\u9664" rid="'+t.id+'" item_id="'+t.item_id+'" t_id="'+t.t_id+'" >\u5220\u9664</a>':"","</div>",'<div class="reply">','<div class="cor"></div>','<div class="rto">\u56de\u590d\uff1a'+t.mqname+"</div>",'<div class="rzo">','<textarea rid="'+t.id+'"></textarea>','<a href="#" onclick="return false" class="btn_reply" title="\u56de\u590d">\u56de\u590d</a>',"</div>","</div>","</div>","</li>"].join("");$("#qikuComment li").last().before(n)}):$(".moreComment").parent().hide(),o(t.errmsg.allnum),n=e})},s=function(e){$.getJSON("/review/syncmylist/",{c:r,i:t,p:e,n:10,t:+(new Date)},function(t){qiku.token_=t.errmsg.token_,t.errmsg.num<10||t.errmsg.allnum<=10?$("#qikuComment").children(".nobdr").hide():(t.errmsg.num=10)&&$("#qikuComment").children(".nobdr").show(),t.errmsg.num!=0?($("#qikuComment li").not(".nobdr").remove(),t.errmsg.num<10||t.errmsg.allnum<=10?$("#qikuComment").children(".nobdr").hide():(t.errmsg.num=10)&&$("#qikuComment").children(".nobdr").show(),$.each(t.errmsg.data,function(e,t){var n=["<li>",'<div class="pic">','<img src="'+t.mimageUrl+'" alt="'+t.mqname+'" title="'+t.mqname+'" />',t.issuperadmin==1?'<a style="color:red;" qid="'+t.qid+'" href="#" onclick="return false;" class="moveblack">\u62c9\u9ed1</a>':"","</div>",'<div class="txt">',t.isadmin==0?'<div class="nick">'+t.mqname+"</div>":'<div class="nick">'+t.mqname+'<span class="vip" title="\u4ea7\u54c1\u56e2\u961f"></span></div>',t.reply_qid==""?"":'<div class="quote"><span class="time">'+t.qname+"\u53d1\u8868\u4e8e "+t.refresh_at+'</span><div class="con">'+t.reply_content+"&nbsp;</div></div>",'<div class="content">'+t.content+"&nbsp;</div>",'<div class="info">','<span class="time">'+t.post_at+"</span>",'<a href="#" onclick="return false" class="breply" title="\u56de\u590d">\u56de\u590d</a>',t.issuperadmin==1?'<a href="#" onclick="return false" class="delrcm" title="\u5220\u9664" rid="'+t.id+'" item_id="'+t.item_id+'" t_id="'+t.t_id+'" >\u5220\u9664</a>':"","</div>",'<div class="reply">','<div class="cor"></div>','<div class="rto">\u56de\u590d\uff1a'+t.mqname+"</div>",'<div class="rzo">','<textarea rid="'+t.id+'"></textarea>','<a href="#" onclick="return false" class="btn_reply" title="\u56de\u590d">\u56de\u590d</a>',"</div>","</div>","</div>","</li>"].join("");$("#qikuComment li").last().before(n)})):($("#qikuComment li").not(".nobdr").remove(),$(".moreComment").parent().hide(),$("#qikuComment li").last().before('<li style="margin-top:30px;text-align:center;font-size:18px;color:#333;border-bottom:0;">\u6682\u65f6\u6ca1\u6709\u4e0e\u60a8\u76f8\u5173\u7684\u8bc4\u8bba</li>')),n=e})},o=function(e){$(".tab_comment_num").text(e)},u=function(){$(".moreComment").click(function(){i(n+1),n++})},a=function(){var e=!1;$("#writeCommentBtn").click(function(){if(e)return;var n=$("#writeComment").val();$(".com_aboutme span").hasClass("slted")&&$(".com_aboutme input").trigger("click"),QHPass.login(function(){if($.trim(n).length>200||$.trim(n).length<5)$("#review-warn").html('<span style="font-size:12px;font-weight:normal;font-fmaily:simsun!important;float:right;margin-top:8px;color:#ff0000">\u8bc4\u8bba\u5b57\u6570\u5e94\u57285-200\u5b57\u4e4b\u95f4</span>');else{var s=n,o=t,u=r;e=!0,$.post("/review/syncpls",{content:s,item_id:o,tag_major:u,token_:qiku.token_},function(t){e=!1,$("#qikuComment li").not(".nobdr").remove(),i(1),t.errno!=0&&$("#review-warn").html('<span style="font-size:12px;font-weight:normal;font-fmaily:simsun!important;float:right;margin-top:8px;color:#ff0000">'+t.errmsg+"</span>")},"json"),$("#writeComment").val("").blur(),$("#review-warn").html("\u8fd8\u53ef\u4ee5\u8f93\u5165<em>200</em>\u5b57")}},{cookie_domains:["1360|360|qikoo|qiku"]})}),$("#writeComment").on("keyup",function(){var e=$.trim($("#writeComment").val()).length;e<=200?$("#review-warn").html("\u8fd8\u53ef\u4ee5\u8f93\u5165 <em>"+(200-e)+"</em> \u5b57"):$("#review-warn").html('\u5df2\u7ecf\u8d85\u51fa <em style="qikcolor:#f00;">'+(e-200)+"</em> \u5b57")})},f=function(){i(1)},l=function(){s(1)},c=function(e){confirm("\u786e\u5b9a\u8981\u5220\u9664\u6b64\u6761\u8bc4\u8bba\uff1f")&&$.post("/review/syncmdel",{rid:e.attr("rid"),i_id:e.attr("item_id"),t_id:e.attr("t_id")},function(t){e.parent().parent().parent().remove()})},h=function(e){confirm("\u786e\u5b9a\u8981\u5c06\u6b64\u7528\u6237\u62c9\u9ed1\uff1f")&&$.post("/review/syncmblack",{qid:e.attr("qid")},function(e){window.location.reload()})},p=function(){$("#qikuComment").on("click",".breply",function(){var e=$(this).parent().next(".reply");e.toggle().find("textarea").focus()}),$("#qikuComment").on("click",".delrcm",function(){var e=$(this);c(e)}),$("#qikuComment").on("click",".moveblack",function(){var e=$(this);h(e)}),$("#qikuComment").on("click",".btn_reply",function(){var e=$(this),n=e.prev("textarea").val();QHPass.login(function(){if($.trim(n).length>200||$.trim(n).length<5)return $(".reply_warn").remove(),e.after('<span class="reply_warn" style="color:#ff0000;">\u56de\u590d\u5b57\u6570\u5e94\u57285-200\u5b57\u4e4b\u95f4</span>'),!1;var s=n,o=e.prev("textarea").attr("rid"),u=t,a=r;$.post("/review/synchf",{reply_content:s,rid:o,item_id:u,tag_major:a,token_:qiku.token_},function(e){$("#qikuComment li").not(".nobdr").remove(),i(1),e.errno!=0&&$("#review-warn").html('<span style="font-size:12px;font-weight:normal;font-fmaily:simsun!important;float:right;margin-top:8px;color:#ff0000">'+e.errmsg+"</span>")},"json")},{cookie_domains:["1360|360|qikoo|qiku"]})})},d=function(e,t){$(".com_aboutme input").click(function(n){_this=$(n.target),_this.siblings("span").hasClass("slted")?(_this.siblings("span").removeClass("slted"),$("#qikuComment li").not(".nobdr").remove(),i({id:e,tag:t})):(_this.siblings("span").addClass("slted"),s({id:e,tag:t}))})},v=function(e){t=e.id,r=e.tag||r,p(),u(),a(),f(),d(t,r)},m=function(e){t=e.id,r=e.tag||r,p(),u(),a(),l()};return{init:v,initMy:m}}();qikoo=qikoo||{},qikoo.widget=qikoo.widget||{},qikoo.widget.product=function(){var e=function(e){var t=$(e).find(".product-des");t.animate({height:30},100)},t=function(e){var t=$(e).find(".product-des");t.animate({height:0},100)},n=function(n){n=n||$(".mod-product"),n.each(function(n,r){r=$(r),r.attr("data-hover-binded")!=1&&(r.mouseenter(function(){e(r)}),r.mouseleave(function(){t(r)}),qikoo.like.init(r.find(".product-xh")),r.attr("data-hover-binded",1))})};return{init:n}}(),qikoo=qikoo||{},qikoo.widget=qikoo.widget||{},qikoo.widget.product_new=function(){var e=function(e){e=e||$(".mod-product-new"),e.each(function(e,t){qikoo.like.init($(t).find(".product-like"))})};return{init:e}}();